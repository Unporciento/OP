<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador Examen INACAP - Final</title>
    <style>
        body { font-family: 'Arial', sans-serif; background: #f0f2f5; color: #333; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .card { background: white; width: 100%; max-width: 700px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); padding: 30px; margin-bottom: 20px; border-top: 5px solid #d32f2f; }
        h1 { color: #d32f2f; text-align: center; margin-bottom: 5px; }
        h3 { margin-top: 0; color: #555; text-align: center; font-weight: normal; }
        
        .diagram-box {
            background: #fff; border: 2px solid #333; padding: 15px; margin: 20px 0; position: relative; height: 180px; font-family: monospace;
        }
        
        .wire { position: absolute; background: #333; }
        .component { position: absolute; border: 2px solid #000; padding: 5px; background: #eee; font-weight: bold; font-size: 0.9em; }

        .question { font-size: 1.2em; margin-bottom: 20px; font-weight: bold; }
        
        .options { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        button { padding: 15px; font-size: 1em; cursor: pointer; background: #fff; border: 2px solid #ccc; border-radius: 5px; transition: 0.2s; }
        button:hover { background: #f9f9f9; border-color: #d32f2f; }
        .correct { background: #d4edda !important; border-color: #28a745 !important; color: #155724; }
        .wrong { background: #f8d7da !important; border-color: #dc3545 !important; color: #721c24; }

        .feedback { margin-top: 15px; padding: 15px; background: #e2e3e5; border-radius: 5px; display: none; }
        
        #score-board { font-size: 1.5em; text-align: center; margin-top: 20px; font-weight: bold; }
    </style>
</head>
<body>

<div class="card">
    <h1>EXAMEN TÃ‰CNICO FINAL</h1>
    <h3>SimulaciÃ³n basada en GuÃ­as Reales</h3>
    
    <div id="quiz-container">
        <div class="diagram-box" id="schematic">
            </div>

        <div class="question" id="q-text">Cargando...</div>
        <div class="options" id="opt-box"></div>
        <div class="feedback" id="feedback"></div>
        <button id="next-btn" style="width:100%; margin-top:20px; background:#333; color:white; display:none;" onclick="nextQ()">Siguiente Pregunta</button>
    </div>

    <div id="score-board" style="display:none;">
        NOTA FINAL: <span id="final-grade"></span>
    </div>
</div>

<script>
    const questions = [
        {
            type: "fuse",
            watts: [100, 100, 50], // Suma 250W
            voltage: 24,
            q: "SegÃºn el esquema, indique el rango ideal del fusible FU26 que alimenta a los 3 focos (100W, 100W, 50W) en un sistema de 24V.",
            opts: ["10 Amperios", "15 Amperios", "20 Amperios", "5 Amperios"],
            correct: 1, // 10.4A + 10% = 11.4A -> Usar 15A
            exp: "Potencia Total: 250W.<br>Corriente: 250W / 24V = 10.41A.<br>Con margen (+10%): 11.45A.<br>Fusible comercial superior: <b>15A</b>."
        },
        {
            type: "fuse",
            watts: [55, 55], // Suma 110W
            voltage: 12, // Auto
            q: "Sistema de 12V (AutomÃ³vil). Calcula el fusible para dos focos delanteros de 55W cada uno.",
            opts: ["10 Amperios", "15 Amperios", "5 Amperios", "25 Amperios"],
            correct: 1, // 110W / 12V = 9.16A -> +10% = 10.08A -> Usar 15A (El de 10 queda muy justo)
            exp: "Total: 110W / 12V = 9.16A.<br>Con seguridad: 10.1A.<br>El de 10A se quemarÃ­a eventualmente. Usar <b>15A</b>."
        },
        {
            type: "section",
            q: "Calcule la secciÃ³n del conductor para un consumo de 15A, si la densidad de corriente mÃ¡xima permitida es de 4 A/mmÂ².",
            opts: ["1.5 mmÂ²", "2.5 mmÂ²", "4.0 mmÂ²", "0.5 mmÂ²"],
            correct: 2, // 15 / 4 = 3.75 -> Usar 4mm
            exp: "SecciÃ³n = Intensidad / Densidad.<br>15A / 4 = 3.75 mmÂ².<br>Comercial mÃ¡s cercano hacia arriba: <b>4.0 mmÂ²</b>."
        },
        {
            type: "rectifier",
            q: "En el osciloscopio ves una onda rectificada pero con mucho 'rizado' (baja y sube). Â¿QuÃ© componente falta o estÃ¡ fallando?",
            opts: ["El Diodo", "El Transformador", "El Condensador (Filtro)", "La Resistencia"],
            correct: 2,
            exp: "El <b>Condensador</b> se encarga de aplanar la onda (filtrado). Si falla, aparece el rizado."
        },
        {
            type: "relay",
            q: "Necesitas que una luz se APAGUE cuando activas el interruptor. Â¿A quÃ© pin del relÃ© la conectas?",
            opts: ["87 (Normalmente Abierto)", "87a (Normalmente Cerrado)", "86 (Bobina)", "30 (ComÃºn)"],
            correct: 1,
            exp: "El <b>87a</b> tiene corriente siempre que el relÃ© estÃ¡ DESACTIVADO. Al activar, se corta."
        }
    ];

    let current = 0;
    let score = 0;

    function loadQ() {
        const qData = questions[current];
        document.getElementById('q-text').innerHTML = qData.q;
        
        // Dibujar esquema simple si es de fusibles
        const schematic = document.getElementById('schematic');
        schematic.innerHTML = '';
        if(qData.type === 'fuse') {
            schematic.innerHTML = `
                <div style="position:absolute; top:80px; left:10px; font-weight:bold;">${qData.voltage}V</div>
                <div class="wire" style="top:90px; left:50px; width:50px; height:2px;"></div>
                <div class="component" style="top:75px; left:100px;">FUSIBLE?</div>
                <div class="wire" style="top:90px; left:180px; width:100px; height:2px;"></div>
                
                ${qData.watts.map((w, i) => `
                    <div style="position:absolute; top:20px; left:${300 + i*100}px; border:2px solid #333; border-radius:50%; width:40px; height:40px; display:flex; align-items:center; justify-content:center;">ðŸ’¡</div>
                    <div style="position:absolute; top:70px; left:${310 + i*100}px; font-size:0.8em;">${w}W</div>
                    <div class="wire" style="top:60px; left:${320 + i*100}px; width:2px; height:30px;"></div>
                    <div class="wire" style="top:90px; left:280px; width:100px; height:2px;"></div>
                `).join('')}
            `;
        } else {
            schematic.innerHTML = '<div style="display:flex; justify-content:center; align-items:center; height:100%; color:#777;">(Pregunta TeÃ³rica / CÃ¡lculo)</div>';
        }

        const optBox = document.getElementById('opt-box');
        optBox.innerHTML = '';
        qData.opts.forEach((opt, i) => {
            const btn = document.createElement('button');
            btn.innerText = opt;
            btn.onclick = () => check(btn, i);
            optBox.appendChild(btn);
        });

        document.getElementById('feedback').style.display = 'none';
        document.getElementById('next-btn').style.display = 'none';
    }

    function check(btn, idx) {
        const qData = questions[current];
        const allBtns = document.querySelectorAll('button');
        allBtns.forEach(b => b.disabled = true);

        const fb = document.getElementById('feedback');
        fb.style.display = 'block';

        if(idx === qData.correct) {
            btn.classList.add('correct');
            fb.innerHTML = `<b style="color:green">Â¡Correcto!</b><br>${qData.exp}`;
            score++;
        } else {
            btn.classList.add('wrong');
            fb.innerHTML = `<b style="color:red">Incorrecto.</b><br>${qData.exp}`;
        }
        document.getElementById('next-btn').style.display = 'block';
    }

    function nextQ() {
        current++;
        if(current < questions.length) {
            loadQ();
        } else {
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('score-board').style.display = 'block';
            let grade = (score / questions.length) * 7;
            if(grade < 1) grade = 1;
            document.getElementById('final-grade').innerText = grade.toFixed(1);
        }
    }

    loadQ();
</script>

</body>
</html>
